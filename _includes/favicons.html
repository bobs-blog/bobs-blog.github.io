<!-- Favicons -->
<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="{{ '/assets/img/favicons/favicon-512x512.png' | relative_url }}"
/>
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="{{ '/assets/img/favicons/favicon-32x32.png' | relative_url }}"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="{{ '/assets/img/favicons/favicon-16x16.png' | relative_url }}"
/>
<link
  rel="shortcut icon"
  href="{{ '/assets/img/favicons/favicon.ico' | relative_url }}"
/>
<link rel="icon" href="{{ '/favicon.ico' | relative_url }}" />

<!-- GLightbox CSS and JS -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>

<!-- GLightbox Initialization -->
<script>
  (function () {
    let glightboxInstance = null;

    function initGLightbox() {
      // Check if GLightbox is loaded
      if (typeof GLightbox === "undefined") {
        setTimeout(initGLightbox, 100);
        return;
      }

      // Initialize GLightbox if not already done
      if (!glightboxInstance) {
        glightboxInstance = GLightbox({
          selector: ".glightbox",
          closeButton: true,
          closeOnOutsideClick: true,
          touchNavigation: true,
          keyboardNavigation: true,
          openEffect: "fade",
          closeEffect: "fade",
        });
        window.glightboxInstance = glightboxInstance;
      }

      // Prevent navigation on all .glightbox links
      document.querySelectorAll("a.glightbox").forEach(function (link) {
        // Remove any existing click handlers by replacing the link
        if (!link.hasAttribute("data-glightbox-setup")) {
          link.setAttribute("data-glightbox-setup", "true");

          link.addEventListener(
            "click",
            function (e) {
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();

              const href = link.getAttribute("href");
              if (href && glightboxInstance) {
                glightboxInstance.open(href);
              }

              return false;
            },
            true
          ); // Capture phase
        }
      });
    }

    // Initialize when DOM is ready
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initGLightbox);
    } else {
      initGLightbox();
    }

    // Also try after page fully loads
    window.addEventListener("load", function () {
      setTimeout(initGLightbox, 100);
      setTimeout(initGLightbox, 500);
    });
  })();
</script>
